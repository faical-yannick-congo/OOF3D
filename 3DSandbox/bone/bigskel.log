OOF.File.LoadStartUp.Data(filename='bonemicro.oofdata')
OOF.Windows.Graphics.New()
OOF.Graphics_1.Settings.Color.Background(color=Gray(value=0.5))
OOF.Windows.Activity_Viewer()
OOF.LayerEditor.LayerSet.New(window='Graphics_1')
OOF.LayerEditor.LayerSet.DisplayedObject(category='Microstructure', object='Bn_326_ROI_0*.bmp')
OOF.LayerEditor.LayerSet.Add_Method(method=MicrostructureMaterialDisplay(no_material=Gray(value=0.0),no_color=RGBColor(red=0.00000,green=0.00000,blue=1.00000)))
OOF.LayerEditor.LayerSet.Send(window='Graphics_1')
OOF.Skeleton.New(name='skeleton', microstructure='Bn_326_ROI_0*.bmp', x_elements=10, y_elements=10, z_elements=10, skeleton_geometry=TetraSkeleton(arrangement='moderate',left_right_periodicity=False,top_bottom_periodicity=False,front_back_periodicity=False))
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=Refine(targets=CheckHomogeneity(threshold=1),criterion=Unconditionally(),alpha=0.7))
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=Refine(targets=CheckHomogeneity(threshold=0.95),criterion=Unconditionally(),alpha=0.7))
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=SnapNodes(targets=SnapHeterogenous(threshold=0.90000000000000002),criterion=Unconditional(alpha=0.90000000000000002)))
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=SnapNodes(targets=SnapHeterogenous(threshold=0.90000000000000002),criterion=Unconditional(alpha=0.90000000000000002)))
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=SnapNodes(targets=SnapHeterogenous(threshold=0.90000000000000002),criterion=Unconditional(alpha=0.90000000000000002)))
OOF.Skeleton.PinNodes.Pin_Internal_Boundary_Nodes(skeleton='Bn_326_ROI_0*.bmp:skeleton')
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=Smooth(targets=AllNodes(),criterion=AverageEnergy(alpha=0.29999999999999999),T=0.0,iteration=FixedIteration(iterations=5)))
OOF.Skeleton.PinNodes.UnpinAll(skeleton='Bn_326_ROI_0*.bmp:skeleton')
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=Rationalize(targets=BadlyShapedElements(threshold=0.90000000000000002),criterion=AverageEnergy(alpha=0.29999999999999999),method=SpecificRationalization(rationalizers=[RemoveBadTetrahedra(acute_angle=15,obtuse_angle=150)])))
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=Rationalize(targets=BadlyShapedElements(threshold=0.80000000000000004),criterion=AverageEnergy(alpha=0.29999999999999999),method=SpecificRationalization(rationalizers=[RemoveBadTetrahedra(acute_angle=15,obtuse_angle=150)])))
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=Rationalize(targets=BadlyShapedElements(threshold=0.80000000000000004),criterion=AverageEnergy(alpha=0.29999999999999999),method=SpecificRationalization(rationalizers=[RemoveBadTetrahedra(acute_angle=15,obtuse_angle=150)])))
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=SnapRefine(targets=CheckHomogeneity(threshold=0.9),criterion=Unconditionally(),min_distance=1,alpha=0.7))
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=SnapNodes(targets=SnapHeterogenous(threshold=0.90000000000000002),criterion=Unconditional(alpha=0.90000000000000002)))
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=SnapNodes(targets=SnapHeterogenous(threshold=0.90000000000000002),criterion=Unconditional(alpha=0.90000000000000002)))
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=SnapNodes(targets=SnapHeterogenous(threshold=0.90000000000000002),criterion=Unconditional(alpha=0.90000000000000002)))
OOF.NodeSelection.Select_Internal_Boundaries(skeleton='Bn_326_ROI_0*.bmp:skeleton', ignorePBC=False)
OOF.Skeleton.Modify(skeleton='Bn_326_ROI_0*.bmp:skeleton', modifier=SurfaceSmooth(targets=SelectedNodes(),criterion=AverageEnergy(alpha=0.29999999999999999),T=0.0,iteration=FixedIteration(iterations=30)))

